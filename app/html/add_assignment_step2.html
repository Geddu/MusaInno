<head>
	<link rel="stylesheet" href="/app/css/assignments.css">
	<link rel="import" href="/app/html/kulut_modal.html">

	<script type= 'text/javascript'>     
		function kulut(){
			console.log("Moi");      
			$("#includedContent").load("/app/html/kulut_modal.html");     
			console.log("Moi");
		};   
		console.log("Moi");

		
	</script> 

</head>

<body onload = "kulut()">
	<div ui-view name="menu"></div>
	<div class="container background bpadding" ng-controller="addAssignmentCtrl">
		<div class="row">
			<center>
				<h1>Palkkajako</h1>
			</center>
		</div>
		<div class="row">
			<button ng-click="test()">TEST</button>
			<!-- Artistien lisäys -->
			<div class="col-md-12 col-sm-12 col-xs-12" style="border-bottom: 1px dotted black;">
				<div class="row">
					<div class="col-md-6 col-sm-6 col-xs-12" style="padding-right: 30px; padding-top: 20px;">
						<form class="form-horizontal">
							<div class="row">
								<div class="col-md-12">
									<label class="pull-right" for="kulut1">
										<input class="pull-right" type="radio" name="kulut" id="kulut2"
										ng-value="true" ng-model="yhtKulut"/>
										<span>Jako henkilökohtaisen laskutusosuuden mukaan &nbsp;</span>
									</label>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<label class="pull-right" for="kulut2">
										<input class="pull-right" type="radio" name="kulut" id="kulut2"
										ng-value="false" ng-model="yhtKulut"/>
										<span>Jako verottomien kulujen jälkeen &nbsp;</span>
									</label>
								</div>
							</div>
						</form>
						<br><br>
					</div>
					<div class="col-md-6 col-sm-6 col-xs-12" style="padding-right: 30px;">
						<div class="row" style="border-bottom: 1px dotted;">
							<div class="col-md-10 col-sm-10 col-xs-10">
								<h3>Laskutettava summa:</h3>
							</div>
							<div class="col-md-2 col-sm-2 col-xs-2">
								<h3 class="pull-right">900€</h3>
							</div>
						</div>
						<div class="row" ng-hide="yhtKulut" style="border-bottom: 1px dotted;">
							<div class="col-md-10 col-sm-10 col-xs-10">
								<p style="padding-left: 10px;">Palkanmaksuprovisio (4,5%)</p>
							</div>
							<div class="col-md-2 col-sm-2 col-xs-2">
								<p class="pull-right">50€</p>
							</div>
							<div class="col-md-10 col-sm-10 col-xs-10">
								<label class="not-bold" style="padding-left: 10px;" ng-click="piilotaKulut()">
									<span class="glyphicon glyphicon-chevron-down" 
									ng-hide="kulut"></span>
									<span class="glyphicon glyphicon-chevron-right" 
									ng-show="kulut"></span>
									Verottomat kulut
								</label>
							</div>
							<div class="col-md-2 col-sm-2 col-xs-2">
								<p class="pull-right">50€</p>
							</div>
							<div class="col-md-12 col-sm-12 col-xs-12" ng-hide="kulut">
								<div class="col-md-10 col-sm-10 col-xs-10">
									<p style="padding-left: 20px;">Börje Efterson</p>
								</div>
								<div class="col-md-10 col-sm-10 col-xs-10">
									<p style="padding-left: 30px;">Km-korvaus 9€</p>
								</div>
								<div class="col-md-10 col-sm-10 col-xs-10">
									<p style="padding-left: 30px;">Päiväraha 41€</p>
								</div>
							</div>
							<div class="col-md-10 col-sm-10 col-xs-10">
								<p style="padding-left: 10px;">TAS (22,23%)</p>
							</div>
						</div>
						<div class="row">
							<div class="col-md-10 col-sm-10 col-xs-10">
								<h4 style="padding-left: 10px;">Jaettavaa jäljellä</h4>
							</div>
							<div class="col-md-2 col-sm-2 col-xs-2">
								<h4 class="pull-right">600€</h4>
							</div>
						</div>
					</div>
				</div>
				<div class="row" style="padding-top: 20px;">
					<!-- Artistin lisäys ja haku nappula -->
					<form class="form-horizontal centered" ng-submit="lisaaArtisti()">
						<div class="form-group">
							<div class="col-sm-8 col-xs-12 col-md-6 col-md-offset-3 col-sm-offset-1">
								<label class="control-label col-sm-5 col-md-4">
									Lisää palkansaaja
								</label>
								<!-- Lisää käyttäjä -->
								<div class="input-group col-xs-10 col-sm-7 col-md-8 col-xs-offset-1">
									<input type="text" class="form-control" ng-model="osallinen" id="addUser"
									placeholder="Lisää käyttäjän sähköposti..." ng-change="newUser=false; existingUser=false">
									<span class="input-group-btn">
										<button class="btn btn-primary" type="submit">Lisää</button>
									</span>
								</div>
							</div>
						</div>
					</form>
					<!-- TUNTEMATON/UUSI KÄYTTÄJÄ -->
					<div class="alert alert-danger centered col-md-6 col-sm-10 col-xs-10" 
					ng-show="newUser">
					<center>
						<span class="glyphicon glyphicon-alert"></span>
						<em>
							<strong>Käyttäjää ei löytynyt.</strong> Tarkista sähköpostiosoite tai 
							<a href="" data-toggle="modal" data-target="#myModal">kutsu uusi käyttäjä. </a>
						</em>
					</center>
				</div>
				<div class="alert alert-danger centered col-md-4 col-sm-4 col-xs-8" 
				ng-show="existingUser">
				<center>
					<span class="glyphicon glyphicon-alert"></span>
					<em>
						<strong>Käyttäjä on lisätty jo.</strong>
					</em>
				</center>
			</div>
		</div>
	</div>
</div>

<!-- KUTSU UUSI KÄYTTÄJÄ -->
<center>
	<!-- Modal -->
	<div id="myModal" class="modal fade" role="dialog">
	  <div class="modal-dialog">

		<!-- Modal Sisältö-->
		<div class="modal-content">
		  <div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<h3 class="modal-title">Kutsu uusi käyttäjä</h3>
		</div>
		<div class="modal-body">
			<h4>Anna kutsuttavan henkilön Sähköpostiosoite</h4>

			<!-- Lisää email-->
			<br />
			<div class="col-sm-12 col-md-12">
				<label class="control-label col-sm-4 col-md-4">
					Email
				</label>
				<div class="input-group col-sm-8 col-md-8">
					<input type="text" class="form-control" ng-value="osallinen">
				</div>
			</div>
			<br />
			<br />
			
		</div>
		
		<div class="modal-footer">
		  <!-- Peruuta, Lähetä napit -->
		  <button type="button" class="btn btn-default" data-dismiss="modal">Sulje</button>
		  <button type="button" class="btn btn-primary" data-dismiss="modal">Lähetä</button>
	  </div>
  </div>

</div>
</div>
</center>
<!-- /KUTSU UUSI KÄYTTÄJÄ -->

<!-- /KULUT MODAL -->

	<!-- Modal -->
	<div id="kulut" class="modal fade" role="dialog">
	  <div class="modal-dialog">

		<!-- Modal Header-->
		<div class="modal-content">
		  <div class="modal-header text-center">
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<h3 class="modal-title">Kulut</h3>
			<h4>{{editArtisti.first_name}} {{editArtisti.last_name}}</h4>
		</div>

		<!-- Modal body-->
		<div class="modal-body text-center">
			<!-- dropdawn-->
			<div class="row">
			<h5 style="margin-bottom: 18px"> Valitse lisättävän kulun tyyppi listasta ja lisää tarvittavat tiedot.</h5>
			<div class="dropdown col-xs-4 col-xs-offset-4" style="margin-bottom: 12px">
			  <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Lisää kulu
				  <span class="caret"></span></button>
				  <ul class="dropdown-menu">
					<li><a href="" ng-click='addExp(1)'>Päiväraha</a></li>
					<li><a href="" ng-click='addExp(2)'>Kilometrikorvaus</a></li>
					<li><a href="" ng-click='addExp(3)'>Kulukuitti</a></li>
				</ul>
			</div>
			</div>
			


			<div class="row" style="text-align: left;" 
				ng-repeat="exp in temporalExp | orderBy: 'typeId'">


				<!--   PÄIVÄRAHA  #424242 -->
				<div class="col-xs-11 centered">
					<div class="panel-group" ng-show={{exp.typeId==1}}>
						<div class="panel panel-info">
							<div class="panel-heading" data-toggle="collapse" href="#collapse1">
								<h4 class="panel-title">
									<strong>Päiväraha</strong>
									<span class="pull-right"> 32€ </span>
								</h4>
							</div>
							<div id='temporalExp.length' class="panel-collapse collapse in">
								<div class="panel-body">

									<div class="col-xs-4">
										Ihmisten määrä
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" id="i-lkm" placeholder="2" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Reitti
									</div>
									<div class="col-xs-6">
										<input type="text" class="form-control" id="reitti" placeholder="Jostain - Jonnekkin" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Kilometri määrä
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" id="km-lkm" placeholder="32" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Korvaus
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" default="45€" id="korvaus" placeholder="45€" >
									</div>
								
								</div>
							</div>
						</div>
					</div>
				</div>

				<!--   KM KORVAUS   -->
				<div class="col-xs-11 centered">
					<div class="panel-group" ng-show={{exp.typeId==2}}>
						<div class="panel panel-success">
							<div class="panel-heading" data-toggle="collapse" href="#collapse1">
								<h4 class="panel-title">
									<a>Kilometri Korvaus</a>
									<a class="pull-right"> 45€ </a>
								</h4>
							</div>
							<div id="collapse1" class="panel-collapse collapse in">
								<div class="panel-body">

									<div class="col-xs-4">
										Ihmisten määrä
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" id="i-lkm" placeholder="2" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Reitti
									</div>
									<div class="col-xs-6">
										<input type="text" class="form-control" id="reitti" placeholder="Jostain - Jonnekkin" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Kilometri määrä
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" id="km-lkm" placeholder="32" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Korvaus
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" default="45€" id="korvaus" placeholder="45€" >
									</div>
									


								</div>
							</div>
						</div>
					</div>
				</div>

					
				
				<!--    KULUKUITTI      -->
				<div class="col-xs-11 centered">
					<div class="panel-group" ng-show={{exp.typeId==3}}>
						<div class="panel panel-warning">
							<div class="panel-heading" data-toggle="collapse" href="#collapse1">
								<h4 class="panel-title">
									<a>Kulukuitti</a>
									<a class="pull-right"> 15€ </a>
								</h4>
							</div>
							<div id="collapse1" class="panel-collapse collapse in">
								<div class="panel-body">

									<div class="col-xs-4">
										Ihmisten määrä
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" id="i-lkm" placeholder="2" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Reitti
									</div>
									<div class="col-xs-6">
										<input type="text" class="form-control" id="reitti" placeholder="Jostain - Jonnekkin" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Kilometri määrä
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" id="km-lkm" placeholder="32" >
									</div>
									<br>
									<br>

									<div class="col-xs-4">
										Korvaus
									</div>
									<div class="col-xs-3">
										<input type="text" class="form-control" default="45€" id="korvaus" placeholder="45€" >
									</div>
					
								</div>
							</div>
						</div>
					</div>
				</div>


			</div>
			<div style="text-align: right" ng-show="temporalExp.length > 0">
				<strong >Yhteensä: 48,3€</strong>
			</div>
		</div>
		
		<div class="modal-footer">
		  <!-- Peruuta, Lähetä napit -->
		  <button type="button" class="btn btn-default" data-dismiss="modal"
		  	ng-click="deleteExp()">Sulje</button>
		  <button type="button" class="btn btn-primary" data-dismiss="modal"
		  	ng-click="saveExp()">Tallenna</button>
	  </div>
  </div>

</div>
</div>

<!-- /KULUT MODAL -->

<!-- LISÄTYT KÄYTTÄJÄT -->
<div id="lisätyt-käyttäjät">
	<table class="table">
		<thead>
			<th><center>Nimi</center></th>
			<th><center>Osuus</center></th>
			<th><center>Palkka</center></th>
		</thead>
		<tbody>
			<tr ng-repeat="u in artistit track by $index">
				<td>
					<center>
						<label class="not-bold" ng-click="piilotaHenkiloKulut($index)">
							<span class="glyphicon glyphicon-chevron-down" 
							ng-hide="u.naytaKulut"></span>
							<span class="glyphicon glyphicon-chevron-right" 
							ng-show="u.naytaKulut"></span>
							<strong>{{u.first_name}} {{u.last_name}}</strong>
						</label>
					</center>
				</td>
				<td>
					<div class="row">
						<div class="col-md-3 col-md-offset-3 col-sm-6">
							<div class="input-group">
								<input class="form-control" type="number" min="0" max="100" 
								name="prosenttiOsuus" aria-describedby="percent">
								<span class="input-group-addon" id="percent">%</span>
							</div> 
						</div>
						<div class="col-md-4 col-sm-6">
							<div class="input-group">
								<input class="form-control" type="number" name="rahaOsuus" aria-describedby="amount">
								<span class="input-group-addon" id="amount">€</span>
							</div>
						</div>
					</div>
					<div ng-hide="u.naytaKulut">
						<div class="row" style="padding-top: 10px;">
							<div class="col-md-6 col-sm-12 col-md-offset-3">
								<div class="col-md-8 col-sm-8" style="padding-left: 0;">
									<p><em>Palkansaajakohtainen provisio</em></p>
								</div>
								<div class="input-group col-md-4 col-sm-4">
									<input class="form-control input-sm" type="number" style="text-align: right;" 
									aria-describedby="yhtHlo" ng-model="u.yhtHloProvisio" ng-change="intToCurrency($index)">
									<span class="input-group-addon" id="yhtHlo">€</span>
								</div>
							</div>
						</div>
						<div class="row" ng-repeat="kulu in u.kulut">
							<div class="col-md-6 col-sm-12 col-md-offset-3">
								<div class="col-md-8 col-sm-8 col-xs-8" style="padding-left: 0;">
									<p><em>{{ kulu.type }}</em></p>
								</div>
								<div class="col-md-4 col-sm-4 col-xs-4">
									<p style="text-align: right;"><em>{{ kulu.amount }}€</em></p>
								</div>
							</div>
						</div>
					</div>
					<div class="row centered">
						<div class="col-md-6 col-md-offset-6 col-sm-5 col-sm-offset-6">
							<!-- Lisää Kulut AVATAAN MODAL tietylle henkilölle-->
							<a href="" ng-click="chooseArtist($index)" data-toggle="modal" data-target="#kulut">Lisää kulut. </a>
						</div>
					</div>
				</td>
				<td><center>170€</center></td>
				<td>
					<button type="button" class="close" ng-click="poistaArtisti(u)">&times;</button>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<!-- /LISÄTYT KÄYTTÄJÄT -->

<!-- Progress bar-->
<div class="row tmargin">
	<div class="col-sm-12 col-xs-12 col-md-12">
		<div class="progress">
			<div class="progress-bar w66" role="progressbar" aria-valuenow="70"
			aria-valuemin="0" aria-valuemax="100">
			<span class="sr-only">66% Complete</span>
		</div>
	</div>
</div>
</div>
<!-- ############# -->
<div class="row">
	<div class="col-sm-2 col-xs-2 col-md-2 col-md-offset-10">
		<button ui-sref="add_assignment({id:'3'})" class="btn btn-primary">Lähetä</button>
	</div>
</div>

</div>
</body>
